---
id: deployment/branches
category: deployment
title: Branches
status: draft
tags: [git, branches, workflow, deployment, strategy]
---

# Branches

**Objective**: Define Git branches and their respective roles in the deployment process.
**Context**: To be applied for deployment and continuous integration stages.

## Explanation

The branch architecture follows a simple and effective strategy to support the deployment workflow:

| Branch        | Environment   | Protection | Deployment       | Usage                              |
| ------------- | ------------- | ---------- | ---------------- | ---------------------------------- |
| `main`        | Production    | ✅ Yes     | Auto (Vercel)    | Stable and tested code in production |
| `dev`         | Staging       | ✅ Yes     | Auto (Vercel)    | Continuous integration, pre-prod   |
| `feature/*`   | Preview       | ❌ No      | Auto (Vercel)    | Development of new features        |
| `fix/*`       | Preview       | ❌ No      | Auto (Vercel)    | Bug fixes                          |
| `hotfix/*`    | Preview       | ❌ No      | Manual review    | Urgent production fixes            |

**Typical workflow:**

```
feature/new-feature → PR to dev → merge dev → test staging → PR to main → production
```

**Branch protections:**
- `main` and `dev` are protected.
- Requires at least 1 approval before merge.
- CI must pass (lint, tests, build).
- No force push allowed.
- No direct commit (only via PR).

## Practical Implementation Example

**Creating a new feature:**

```bash
# From dev
git checkout dev
git pull origin dev

# Create a feature branch
git checkout -b feature/user-profile

# Develop, commit, push
git add .
git commit -m "feat: add user profile page"
git push origin feature/user-profile

# Create a PR to dev
# → Vercel automatically deploys a preview
# → CI checks lint/test/build
# → Review + merge to dev
# → Vercel deploys to staging

# When dev is stable, create a PR dev → main
# → CI checks again
# → Review + merge to main
# → Vercel deploys to production
```

**GitHub configuration (Branch Protection Rules):**

```
Branch: main
  ✅ Require pull request before merging
  ✅ Require approvals: 1
  ✅ Require status checks to pass (CI)
  ✅ Require branches to be up to date
  ❌ Allow force pushes
  ❌ Allow deletions
  
Branch: dev
  ✅ Require pull request before merging
  ✅ Require approvals: 1
  ✅ Require status checks to pass (CI)
  ✅ Require branches to be up to date
  ❌ Allow force pushes
  ❌ Allow deletions
```

**Naming conventions:**

```
feature/feature-name     → New features
fix/bug-description      → Bug fixes
hotfix/critical-issue    → Urgent fixes
refactor/module-name     → Refactoring
docs/topic               → Documentation
test/test-name           → Adding tests
chore/task               → Technical tasks
```

**Vercel configuration per branch:**

```
Production Branch: main
  → Deploy to: myapp.com
  
Git Branch: dev
  → Deploy to: staging.myapp.com
  
All other branches:
  → Deploy to: [branch]-myapp.vercel.app
```

## Variants or Exceptions

- **Gitflow**: Use `develop` instead of `dev`, add `release/*` branches.
- **Trunk-based**: Everyone works on `main` with feature flags.
- **Direct hotfix**: Allow `hotfix/*` → `main` in emergencies, then backport to `dev`.
- **Environment branches**: Add `staging`, `qa` as persistent branches.
- **Monorepo**: Prefix branches by scope (`frontend/feature-x`, `backend/fix-y`).

## Links / References

- [GitHub Branch Protection](https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/about-protected-branches)
- [Vercel Git Integration](https://vercel.com/docs/concepts/git)
- [Git Flow](https://nvie.com/posts/a-successful-git-branching-model/)
- Internal documentation: `.cursor/docs/references.md`
