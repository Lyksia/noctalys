---
alwaysApply: false
description: Enable imports from the root of a feature via index.ts
---

# Feature Barrels

**Objective**: Enable imports from the root of a feature via `index.ts` to simplify imports and encapsulate implementation.

**Context**: To apply for unifying code style and conventions.

## Explanation

Each feature must expose a public API via a root `index.ts` file that groups all public exports. This allows importing from the root of the feature rather than from subdirectories.

**Advantages:**

- Simplified and readable imports
- Encapsulation of internal implementation
- Facilitates refactoring (internal changes without impact on imports)
- Clear and documented public API

## Practical Implementation Example

**Structure of a feature with barrels:**

```
features/calendar/
 ├─ components/
 │   ├─ calendar-grid.tsx        → export { CalendarGrid }
 │   ├─ calendar-event.tsx       → export { CalendarEvent }
 │   ├─ calendar-header.tsx      → export { CalendarHeader }
 │   └─ index.ts                 → Components barrel
 ├─ hooks/
 │   ├─ use-calendar.ts          → export { useCalendar }
 │   ├─ use-calendar-events.ts   → export { useCalendarEvents }
 │   └─ index.ts                 → Hooks barrel
 ├─ services/
 │   ├─ calendar-api.ts          → export { fetchEvents, createEvent, ... }
 │   └─ index.ts                 → Services barrel
 ├─ utils/
 │   ├─ date-utils.ts            → export { formatEventDate, ... }
 │   └─ index.ts                 → Utils barrel (if public)
 ├─ types.ts                     → export type { CalendarEvent, ... }
 ├─ constants.ts                 → export const CALENDAR_VIEWS = ...
 └─ index.ts                     → Root barrel (public API)
```

**Root barrel of a feature:**

```ts
// features/calendar/index.ts

// Export everything that should be public
export * from "./components";
export * from "./hooks";
export * from "./services";
export * from "./types";
export * from "./constants";

// DO NOT export internal utils (unless necessary)
// export * from "./utils"; // ❌ If utils are internal only
```

**Subdirectory barrel:**

```ts
// features/calendar/components/index.ts

export { CalendarGrid } from "./calendar-grid";
export { CalendarEvent } from "./calendar-event";
export { CalendarHeader } from "./calendar-header";

// Don't export internal components
// export { InternalHelper } from "./internal-helper"; // ❌
```

**Hooks barrel:**

```ts
// features/calendar/hooks/index.ts

export { useCalendar } from "./use-calendar";
export { useCalendarEvents } from "./use-calendar-events";
export { useEventDragDrop } from "./use-event-drag-drop";
```

**Services barrel:**

```ts
// features/calendar/services/index.ts

export { fetchEvents, createEvent, updateEvent, deleteEvent } from "./calendar-api";

// Also export parameter types if necessary
export type { FetchEventsParams, CreateEventInput } from "./calendar-api";
```

**Import from another part of the code:**

```tsx
// ✅ Good: import from the root of the feature
import { CalendarGrid, CalendarEvent, useCalendar, fetchEvents } from "@/features/calendar";
import type { CalendarEvent as Event, CalendarFilters } from "@/features/calendar";

export function CalendarPage() {
  const { currentDate } = useCalendar();
  const { events } = useCalendarEvents();

  return (
    <div>
      <CalendarGrid events={events} />
    </div>
  );
}

// ❌ Bad: deep imports
import { CalendarGrid } from "@/features/calendar/components/calendar-grid";
import { useCalendar } from "@/features/calendar/hooks/use-calendar";
import { fetchEvents } from "@/features/calendar/services/calendar-api";
```

**Selective export:**

```ts
// features/calendar/index.ts

// Export only the public API
export { CalendarGrid, CalendarHeader } from "./components";
// Don't export CalendarEvent if it's an internal component

export { useCalendar, useCalendarEvents } from "./hooks";
// Don't export useInternalHelper if it's internal

export { fetchEvents, createEvent } from "./services";
// Don't export internal functions

export type { CalendarEvent, CalendarFilters, CalendarView } from "./types";
```

**Handling name conflicts:**

```ts
// features/calendar/index.ts

// If two exports have the same name, rename one of them
export { CalendarEvent as EventComponent } from "./components";
export type { CalendarEvent as EventType } from "./types";

// Or use named exports
export { CalendarEvent } from "./components/calendar-event";
export type { CalendarEvent as CalendarEventType } from "./types";
```

**Barrel with namespace (optional):**

```ts
// features/calendar/index.ts

// Group exports by category
export * as Components from "./components";
export * as Hooks from "./hooks";
export * as Services from "./services";
export * as Types from "./types";

// Import with namespace
import { Components, Hooks } from "@/features/calendar";

const grid = <Components.CalendarGrid />;
const { currentDate } = Hooks.useCalendar();
```

**Documented barrel:**

```ts
// features/calendar/index.ts

/**
 * Calendar feature public API
 *
 * @module features/calendar
 * @description Full-featured calendar with event management
 *
 * @example
 * ```tsx
 * import { CalendarGrid, useCalendar } from "@/features/calendar";
 *
 * const { events } = useCalendar();
 * return <CalendarGrid events={events} />;
 * ```
 */

// Components
export { CalendarGrid } from "./components";
export { CalendarHeader } from "./components";

// Hooks
export { useCalendar } from "./hooks";
export { useCalendarEvents } from "./hooks";

// Services
export { fetchEvents, createEvent, updateEvent, deleteEvent } from "./services";

// Types
export type { CalendarEvent, CalendarFilters, CalendarView } from "./types";
```

**Feature with sub-features:**

```
features/payment/
 ├─ stripe/
 │   ├─ components/
 │   ├─ hooks/
 │   └─ index.ts           → Sub-feature barrel
 ├─ paypal/
 │   ├─ components/
 │   ├─ hooks/
 │   └─ index.ts
 ├─ components/
 ├─ hooks/
 └─ index.ts               → Root barrel

// payment/index.ts
export * from "./components";
export * from "./hooks";
export * as Stripe from "./stripe";
export * as PayPal from "./paypal";

// Import
import { PaymentForm, Stripe, PayPal } from "@/features/payment";
```

**Avoid circular exports:**

```ts
// ❌ Bad: circular export
// features/calendar/components/calendar-grid.tsx
import { useCalendar } from "@/features/calendar"; // Imports from root barrel

// features/calendar/index.ts
export * from "./components"; // Exports CalendarGrid which imports from this same file

// ✅ Good: direct import from subdirectory
// features/calendar/components/calendar-grid.tsx
import { useCalendar } from "../hooks/use-calendar";
```

**Performance: selective exports vs export *:**

```ts
// ✅ Good: selective exports (better for tree-shaking)
export { CalendarGrid } from "./components/calendar-grid";
export { CalendarEvent } from "./components/calendar-event";
export { useCalendar } from "./hooks/use-calendar";

// ⚠️ Acceptable but less optimal
export * from "./components";
export * from "./hooks";
```

## Variants or Exceptions

- Very simple features (< 3 files) can omit intermediate barrels.
- Internal utils should not be exported in the root barrel.

## Links / References

- [TypeScript Barrel Pattern](https://basarat.gitbook.io/typescript/main-1/barrel)
- [Module Pattern](https://www.patterns.dev/posts/module-pattern/)
- Internal documentation: `references.md`
